(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();class q{size;cells;constructor(e=4){this.size=e,this.cells=Array.from({length:e},()=>Array(e).fill(0))}addRandomTile(){const e=this.getEmptyCells();if(e.length===0)return;const[t,r]=e[Math.floor(Math.random()*e.length)],s=Math.random();s<.9?this.cells[t][r]=2:s<.995?this.cells[t][r]=4:(console.log("Easter Egg! You got an 8 tile!"),this.cells[t][r]=8)}getEmptyCells(){const e=[];for(let t=0;t<this.size;t++)for(let r=0;r<this.size;r++)this.cells[t][r]===0&&e.push([t,r]);return e}isGameOver(){if(this.getEmptyCells().length>0)return!1;for(let e=0;e<this.size;e++)for(let t=0;t<this.size;t++)if(e>0&&this.cells[e][t]==this.cells[e-1][t]||e<this.size-1&&this.cells[e][t]==this.cells[e+1][t]||t>0&&this.cells[e][t]==this.cells[e][t-1]||t<this.size-1&&this.cells[e][t]==this.cells[e][t+1])return!1;return!0}compressArray(e){let t=0,r=e.filter(s=>s!==0);for(let s=0;s<r.length-1;s++)r[s]===r[s+1]&&(r[s]*=2,t+=r[s],r[s+1]=0);for(r=r.filter(s=>s!==0);r.length<this.size;)r.push(0);return{newArray:r,points:t}}arraysEqual(e,t){return e.length===t.length&&e.every((r,s)=>r===t[s])}moveLeft(){let e=!1,t=0;for(let r=0;r<this.size;r++){const s=this.cells[r],{newArray:o,points:l}=this.compressArray(s);this.arraysEqual(s,o)||(this.cells[r]=o,e=!0,t+=l)}return{moved:e,score:t}}moveRight(){let e=!1,t=0;for(let r=0;r<this.size;r++){const s=this.cells[r],{newArray:o,points:l}=this.compressArray([...s].reverse()),i=o.reverse();this.arraysEqual(s,i)||(this.cells[r]=i,e=!0,t+=l)}return{moved:e,score:t}}moveUp(){let e=!1,t=0;for(let r=0;r<this.size;r++){const s=[];for(let i=0;i<this.size;i++)s.push(this.cells[i][r]);const{newArray:o,points:l}=this.compressArray(s);if(!this.arraysEqual(s,o)){for(let i=0;i<this.size;i++)this.cells[i][r]=o[i];e=!0,t+=l}}return{moved:e,score:t}}moveDown(){let e=!1,t=0;for(let r=0;r<this.size;r++){const s=[];for(let u=0;u<this.size;u++)s.push(this.cells[u][r]);const{newArray:o,points:l}=this.compressArray([...s].reverse()),i=o.reverse();if(!this.arraysEqual(s,i)){for(let u=0;u<this.size;u++)this.cells[u][r]=i[u];e=!0,t+=l}}return{moved:e,score:t}}}function x(n){const e=document.getElementById("game-board");e.innerHTML="";const t=n.size,s=(e.clientWidth-20)/t-10;e.style.setProperty("--tile-size",`${s}px`),n.cells.forEach(o=>{o.forEach(l=>{const i=document.createElement("div");i.className="tile",l!==0&&(i.textContent=l.toString(),i.style.background=P(l),i.style.color=l<=4?"#776e65":"#f9f6f2"),e.appendChild(i)})})}function P(n){switch(n){case 2:return"#eee4da";case 4:return"#ede0c8";case 8:return"#f2b179";case 16:return"#f59563";case 32:return"#f67c5f";case 64:return"#f65e3b";case 128:return"#edcf72";case 256:return"#edcc61";case 512:return"#edc850";case 1024:return"#edc53f";case 2048:return"#edc22e";case 4096:return"#3c3a32";case 8192:return"#66533c";case 16384:return"#776e65";case 32768:return"#8b7d6b";case 65536:return"#9f8c72";case 131072:return"#b39b79";case 262144:return"#c7aa80";case 524288:return"#dcb988";case 1048576:return"#f0c890";default:return"#3c3a32"}}/*!
 * swiped-events.js - v@version@
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */(function(n,e){typeof n.CustomEvent!="function"&&(n.CustomEvent=function(c,d){d=d||{bubbles:!1,cancelable:!1,detail:void 0};var h=e.createEvent("CustomEvent");return h.initCustomEvent(c,d.bubbles,d.cancelable,d.detail),h},n.CustomEvent.prototype=n.Event.prototype),e.addEventListener("touchstart",O,!1),e.addEventListener("touchmove",R,!1),e.addEventListener("touchend",D,!1);var t=null,r=null,s=null,o=null,l=null,i=null,u=0;function D(c){if(i===c.target){var d=parseInt(z(i,"data-swipe-threshold","20"),10),h=z(i,"data-swipe-unit","px"),y=parseInt(z(i,"data-swipe-timeout","500"),10),C=Date.now()-l,v="",L=c.changedTouches||c.touches||[];if(h==="vh"&&(d=Math.round(d/100*e.documentElement.clientHeight)),h==="vw"&&(d=Math.round(d/100*e.documentElement.clientWidth)),Math.abs(s)>Math.abs(o)?Math.abs(s)>d&&C<y&&(s>0?v="swiped-left":v="swiped-right"):Math.abs(o)>d&&C<y&&(o>0?v="swiped-up":v="swiped-down"),v!==""){var B={dir:v.replace(/swiped-/,""),touchType:(L[0]||{}).touchType||"direct",fingers:u,xStart:parseInt(t,10),xEnd:parseInt((L[0]||{}).clientX||-1,10),yStart:parseInt(r,10),yEnd:parseInt((L[0]||{}).clientY||-1,10)};i.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:B})),i.dispatchEvent(new CustomEvent(v,{bubbles:!0,cancelable:!0,detail:B}))}t=null,r=null,l=null}}function O(c){c.target.getAttribute("data-swipe-ignore")!=="true"&&(i=c.target,l=Date.now(),t=c.touches[0].clientX,r=c.touches[0].clientY,s=0,o=0,u=c.touches.length)}function R(c){if(!(!t||!r)){var d=c.touches[0].clientX,h=c.touches[0].clientY;s=t-d,o=r-h}}function z(c,d,h){for(;c&&c!==e.documentElement;){var y=c.getAttribute(d);if(y)return y;c=c.parentNode}return h}})(window,document);function U(n){const e=document.createElement("div");e.id="game-over-overlay",e.className="overlay hidden",e.innerHTML=`
    <div class="overlay-content">
      <h2>Game Over!</h2>
      <p>Your Score: <span id="final-score">0</span></p>
      <button id="restart-btn">Restart Game</button>
    </div>
  `,document.body.appendChild(e),e.querySelector("#restart-btn").addEventListener("click",()=>{e.classList.add("hidden"),n()})}function Y(n){const e=document.getElementById("game-over-overlay"),t=e.querySelector("#final-score");t.textContent=n.toString(),e.classList.remove("hidden")}function G(){const n=document.getElementById("game-over-overlay");n&&n.classList.add("hidden")}let a,p=0;const g={},E={};function H(n){p+=n;const e=document.getElementById("score");e&&(e.textContent=p.toString())}function A(n){p=n;const e=document.getElementById("score");e&&(e.textContent=p.toString())}let m=document.getElementById("score");m||(m=document.createElement("div"),m.id="score",m.style.fontWeight="bold",m.style.fontSize="1.25rem",m.style.color="#776e65",m.style.marginBottom="10px",document.body.insertBefore(m,document.getElementById("game-board")));function w(n){G(),g[n]?(a=g[n],A(E[n]||0)):(a=new q(n),a.addRandomTile(),a.addRandomTile(),A(0));const e=document.getElementById("game-board");e.classList.add("resizing"),e.style.setProperty("--board-size",n.toString()),x(a),S(),setTimeout(()=>e.classList.remove("resizing"),400)}function f(n){const{moved:e,score:t}=n();e&&(t>0&&H(t),a.addRandomTile(),x(a));const r=parseInt(document.getElementById("board-size").value);g[r]=a,E[r]=p,a.isGameOver()&&Y(p)}document.addEventListener("keydown",n=>{switch(n.key){case"ArrowUp":f(()=>a.moveUp());break;case"ArrowDown":f(()=>a.moveDown());break;case"ArrowLeft":f(()=>a.moveLeft());break;case"ArrowRight":f(()=>a.moveRight());break}});document.addEventListener("swiped-left",()=>f(()=>a.moveLeft()));document.addEventListener("swiped-right",()=>f(()=>a.moveRight()));document.addEventListener("swiped-up",()=>f(()=>a.moveUp()));document.addEventListener("swiped-down",()=>f(()=>a.moveDown()));let M=0,T=0,b=!1;document.addEventListener("mousedown",n=>{M=n.clientX,T=n.clientY,b=!0});document.addEventListener("mouseup",n=>{if(!b)return;const e=n.clientX-M,t=n.clientY-T;if(Math.abs(e)<30&&Math.abs(t)<30){b=!1;return}Math.abs(e)>Math.abs(t)?f(()=>e>0?a.moveRight():a.moveLeft()):f(()=>t>0?a.moveDown():a.moveUp()),b=!1});U(()=>{const n=parseInt(document.getElementById("board-size").value);delete g[n],delete E[n],w(n)});const I=document.getElementById("board-size"),N=document.getElementById("board-size-value"),W=document.getElementById("board-size-value-2"),X=document.getElementById("new-game");I.addEventListener("input",()=>{const n=parseInt(I.value);N.textContent=n.toString(),W.textContent=n.toString(),w(n)});X.addEventListener("click",()=>{const n=parseInt(I.value);delete g[n],delete E[n],w(n)});function S(){const n=document.getElementById("game-board"),e=document.querySelector("h1"),t=document.querySelector(".controls"),r=e.offsetHeight+t.clientHeight+100,s=window.innerWidth-40,o=window.innerHeight-r,l=Math.min(s,o);n.style.width=`${l}px`,n.style.height=`${l}px`;const i=parseInt(getComputedStyle(n).getPropertyValue("--board-size"))||4,u=l/i-10;n.style.setProperty("--tile-size",`${u}px`)}window.addEventListener("resize",S);S();w(4);
