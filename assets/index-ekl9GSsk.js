(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();class D{size;cells;constructor(e=4){this.size=e,this.cells=Array.from({length:e},()=>Array(e).fill(0))}addRandomTile(){const e=this.getEmptyCells();if(e.length===0)return;const[t,s]=e[Math.floor(Math.random()*e.length)],r=Math.random();r<.9?this.cells[t][s]=2:r<.995?this.cells[t][s]=4:(console.log("Easter Egg! You got an 8 tile!"),this.cells[t][s]=8)}getEmptyCells(){const e=[];for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++)this.cells[t][s]===0&&e.push([t,s]);return e}isGameOver(){if(this.getEmptyCells().length>0)return!1;for(let e=0;e<this.size;e++)for(let t=0;t<this.size;t++)if(e>0&&this.cells[e][t]==this.cells[e-1][t]||e<this.size-1&&this.cells[e][t]==this.cells[e+1][t]||t>0&&this.cells[e][t]==this.cells[e][t-1]||t<this.size-1&&this.cells[e][t]==this.cells[e][t+1])return!1;return!0}compressArray(e){let t=0,s=e.filter(r=>r!==0);for(let r=0;r<s.length-1;r++)s[r]===s[r+1]&&(s[r]*=2,t+=s[r],s[r+1]=0);for(s=s.filter(r=>r!==0);s.length<this.size;)s.push(0);return{newArray:s,points:t}}arraysEqual(e,t){return e.length===t.length&&e.every((s,r)=>s===t[r])}moveLeft(){let e=!1,t=0;for(let s=0;s<this.size;s++){const r=this.cells[s],{newArray:i,points:l}=this.compressArray(r);this.arraysEqual(r,i)||(this.cells[s]=i,e=!0,t+=l)}return{moved:e,score:t}}moveRight(){let e=!1,t=0;for(let s=0;s<this.size;s++){const r=this.cells[s],{newArray:i,points:l}=this.compressArray([...r].reverse()),o=i.reverse();this.arraysEqual(r,o)||(this.cells[s]=o,e=!0,t+=l)}return{moved:e,score:t}}moveUp(){let e=!1,t=0;for(let s=0;s<this.size;s++){const r=[];for(let o=0;o<this.size;o++)r.push(this.cells[o][s]);const{newArray:i,points:l}=this.compressArray(r);if(!this.arraysEqual(r,i)){for(let o=0;o<this.size;o++)this.cells[o][s]=i[o];e=!0,t+=l}}return{moved:e,score:t}}moveDown(){let e=!1,t=0;for(let s=0;s<this.size;s++){const r=[];for(let d=0;d<this.size;d++)r.push(this.cells[d][s]);const{newArray:i,points:l}=this.compressArray([...r].reverse()),o=i.reverse();if(!this.arraysEqual(r,o)){for(let d=0;d<this.size;d++)this.cells[d][s]=o[d];e=!0,t+=l}}return{moved:e,score:t}}}function A(n){const e=document.getElementById("game-board");e.innerHTML="";const t=n.size,r=(e.clientWidth-20)/t-10;e.style.setProperty("--tile-size",`${r}px`),n.cells.forEach(i=>{i.forEach(l=>{const o=document.createElement("div");o.className="tile",l!==0&&(o.textContent=l.toString(),o.style.background=B(l),o.style.color=l<=4?"#776e65":"#f9f6f2"),e.appendChild(o)})})}function B(n){switch(n){case 2:return"#eee4da";case 4:return"#ede0c8";case 8:return"#f2b179";case 16:return"#f59563";case 32:return"#f67c5f";case 64:return"#f65e3b";case 128:return"#edcf72";case 256:return"#edcc61";case 512:return"#edc850";case 1024:return"#edc53f";case 2048:return"#edc22e";case 4096:return"#3c3a32";case 8192:return"#66533c";case 16384:return"#776e65";case 32768:return"#8b7d6b";case 65536:return"#9f8c72";case 131072:return"#b39b79";case 262144:return"#c7aa80";case 524288:return"#dcb988";case 1048576:return"#f0c890";default:return"#3c3a32"}}/*!
 * swiped-events.js - v@version@
 * Pure JavaScript swipe events
 * https://github.com/john-doherty/swiped-events
 * @inspiration https://stackoverflow.com/questions/16348031/disable-scrolling-when-touch-moving-certain-element
 * @author John Doherty <www.johndoherty.info>
 * @license MIT
 */(function(n,e){typeof n.CustomEvent!="function"&&(n.CustomEvent=function(a,u){u=u||{bubbles:!1,cancelable:!1,detail:void 0};var h=e.createEvent("CustomEvent");return h.initCustomEvent(a,u.bubbles,u.cancelable,u.detail),h},n.CustomEvent.prototype=n.Event.prototype),e.addEventListener("touchstart",T,!1),e.addEventListener("touchmove",x,!1),e.addEventListener("touchend",M,!1);var t=null,s=null,r=null,i=null,l=null,o=null,d=0;function M(a){if(o===a.target){var u=parseInt(y(o,"data-swipe-threshold","20"),10),h=y(o,"data-swipe-unit","px"),p=parseInt(y(o,"data-swipe-timeout","500"),10),L=Date.now()-l,m="",w=a.changedTouches||a.touches||[];if(h==="vh"&&(u=Math.round(u/100*e.documentElement.clientHeight)),h==="vw"&&(u=Math.round(u/100*e.documentElement.clientWidth)),Math.abs(r)>Math.abs(i)?Math.abs(r)>u&&L<p&&(r>0?m="swiped-left":m="swiped-right"):Math.abs(i)>u&&L<p&&(i>0?m="swiped-up":m="swiped-down"),m!==""){var S={dir:m.replace(/swiped-/,""),touchType:(w[0]||{}).touchType||"direct",fingers:d,xStart:parseInt(t,10),xEnd:parseInt((w[0]||{}).clientX||-1,10),yStart:parseInt(s,10),yEnd:parseInt((w[0]||{}).clientY||-1,10)};o.dispatchEvent(new CustomEvent("swiped",{bubbles:!0,cancelable:!0,detail:S})),o.dispatchEvent(new CustomEvent(m,{bubbles:!0,cancelable:!0,detail:S}))}t=null,s=null,l=null}}function T(a){a.target.getAttribute("data-swipe-ignore")!=="true"&&(o=a.target,l=Date.now(),t=a.touches[0].clientX,s=a.touches[0].clientY,r=0,i=0,d=a.touches.length)}function x(a){if(!(!t||!s)){var u=a.touches[0].clientX,h=a.touches[0].clientY;r=t-u,i=s-h}}function y(a,u,h){for(;a&&a!==e.documentElement;){var p=a.getAttribute(u);if(p)return p;a=a.parentNode}return h}})(window,document);let c,g=0;function R(n){g+=n;const e=document.getElementById("score");e&&(e.textContent=g.toString())}function O(){g=0;const n=document.getElementById("score");n&&(n.textContent=g.toString())}document.getElementById("score");function b(n){O();const e=document.getElementById("game-board");e.classList.add("resizing"),c=new D(n),c.addRandomTile(),c.addRandomTile(),e.style.setProperty("--board-size",n.toString()),A(c),z(),setTimeout(()=>e.classList.remove("resizing"),400)}function f(n){const{moved:e,score:t}=n();e&&(c.addRandomTile(),A(c),t>0&&R(t),c.isGameOver()&&setTimeout(()=>alert("Game Over!"),100))}document.addEventListener("keydown",n=>{switch(n.key){case"ArrowUp":f(()=>c.moveUp());break;case"ArrowDown":f(()=>c.moveDown());break;case"ArrowLeft":f(()=>c.moveLeft());break;case"ArrowRight":f(()=>c.moveRight());break}});document.addEventListener("swiped-left",()=>f(()=>c.moveLeft()));document.addEventListener("swiped-right",()=>f(()=>c.moveRight()));document.addEventListener("swiped-up",()=>f(()=>c.moveUp()));document.addEventListener("swiped-down",()=>f(()=>c.moveDown()));let C=0,I=0,v=!1;document.addEventListener("mousedown",n=>{C=n.clientX,I=n.clientY,v=!0});document.addEventListener("mouseup",n=>{if(!v)return;const e=n.clientX-C,t=n.clientY-I;if(Math.abs(e)<30&&Math.abs(t)<30){v=!1;return}Math.abs(e)>Math.abs(t)?f(()=>e>0?c.moveRight():c.moveLeft()):f(()=>t>0?c.moveDown():c.moveUp()),v=!1});const E=document.getElementById("board-size"),q=document.getElementById("board-size-value"),P=document.getElementById("board-size-value-2"),U=document.getElementById("new-game");E.addEventListener("input",()=>{const n=parseInt(E.value);q.textContent=n.toString(),P.textContent=n.toString(),b(n)});U.addEventListener("click",()=>{const n=parseInt(E.value);b(n)});function z(){const n=document.getElementById("game-board"),e=document.querySelector("h1"),t=document.querySelector(".controls"),s=e.offsetHeight+t.clientHeight+100,r=window.innerWidth-40,i=window.innerHeight-s,l=Math.min(r,i);n.style.width=`${l}px`,n.style.height=`${l}px`;const o=parseInt(getComputedStyle(n).getPropertyValue("--board-size"))||4,d=l/o-10;n.style.setProperty("--tile-size",`${d}px`)}window.addEventListener("resize",z);b(4);z();
